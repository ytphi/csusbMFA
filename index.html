<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" name="apple-mobile-web-app-capable" content="yes" />
    <link rel="shortcut icon" href="favicon.ico" />
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.2/aframe/build/aframe-ar.js"></script>
    <script>
      AFRAME.registerComponent("vidhandler", {
        init: function () {
          this.toggle = false;
          document.querySelector("#vid").pause(); //reference to the video
          console.log("pausing");
        },
        tick: function () {
          if (document.querySelector("a-marker").object3D.visible == true) {
            if (!this.toggle) {
              this.toggle = true;
              document.querySelector("#vid").play();
              console.log("playing");
            }
          } else {
            this.toggle = false;
            document.querySelector("#vid").pause();
            console.log("pausing");
          }
        },
      });
    </script>
    <title>Yutong Liu</title>
  </head>
  <body style="margin: 0px; overflow: hidden">
    <a-scene
      vr-mode-ui="enabled: false;"
      renderer="logarithmicDepthBuffer: true;"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false; trackingMethod: best;"
    >
      <a-assets>
        <video
          id="vid"
          src="./test.mp4"
          preload="auto"
          loop
          autoplay
          playsinline
        ></video>
      </a-assets>
      <a-marker
        type="pattern"
        url="./xREAL-Marker.patt"
        smooth="true"
        smoothThreshold="2"
        smoothTolerance="0.01"
        smoothCount="5"
      >
        <a-entity
          gltf-model="url(./full_screen/untitled.gltf)"
          scale="0.1 0.1 0.1"
          rotation="90 180 0"
        >
          <a-video
            id="vid"
            loop="true"
            vidhandler
            src="#vid"
            width="28.5"
            height="19"
            position="0 0 -1"
          ></a-video>
        </a-entity>
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
  </body>
</html>
